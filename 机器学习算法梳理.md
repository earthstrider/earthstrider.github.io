## 集成学习

**集成学习概念**

西瓜书这样定义集成学习：集成学习通过构建并结合多个学习器来完成学习任务。

集成就是组合或者结合，就是将多个单一学习器（术语是个体学习器）通过某种方式组合在一起使用，以获得比单一学习器更高的学习性能（术语是泛化性能）。

将多个学习能力良莠不齐的单一学习器组合在一起，我们当然希望集成之后的学习器的学习性能比任一单一学习器的学习性能强，就像毛主席所说的众人拾柴火焰高，但真得能实现吗？会不会发生木桶效应或者一颗老鼠屎带坏一锅粥？这就需要我们研究集成学习算法以达到我们的目的。当然这里又可以引出一个自认为是哲学的问题，你更赞成英雄主义还是众人同心？



**个体学习器概念**

个体学习器是集成学习器的组成单元。当然在不同情况下这个词的称呼稍有不同，当集成学习器都是由多个相同个体学习器组成的时候，该个体学习器称为基学习器，例如决策树集成中全是决策树；当集成学习器都是由多个不同个体学习器组成的时候，该个体学习器称为组件学习器。



集成学习研究的核心是如何产生并结合"好而不同"的个体学习器，好代表个体学习器要有一定的"准确性"，不同代表个体学习器间具有差异，或者说"多样性"。



P1：Hoeffding不等式



**个体学习器生成策略**

Boosting

先从初始训练集训练出一个个体学习器，后续学习器更关注前一个学习器表现不好的样本，如此重复进行，知至学习器的数目达到指定的值T，最终将这T个个体学习器进行加权结合。



Bagging

使用相互有交叠的样本子集训练出不同的个体学习器，在对预测输出进行结合时，Bagging通常对分类任务使用简单的投票法，对回归任务使用简单平均法。

同：都是训练不同的个体学习器，然后对这些个体学习器进行结合。

异：因为要使个体学习器间具有差异，Boosting和Bagging采用的方式不同。



随机森林

随机森林是Bagging的一个扩展变体。在样本扰动的基础上，加上属性扰动。



**个体学习器结合策略**

平均法

投票法

学习法





## 决策树

介绍随机森林之前，复(yu)习(xi)下决策树。




决策树学习采用的是自顶向下的递归方法，其基本思想是以**信息熵**为度量构造一颗熵值下降最快的树。理想情况是所有叶子节点处的熵值为零，此时每个叶节点中的实例都属于同一类。

下面介绍熵以及条件熵的定义。



**信息熵**

香龙把随机变量$X$的**熵**值$H$(希腊字母Eta)定义如下，$X$值域为${x_1,…,x_n}$：
$$
H(X)=E[I(X)]=E[-ln(P(X))]
$$
当取自有限的样本时，熵的公式可以表示为：
$$
H(X)=\sum P(x_i)I(x_i)=-\sum P(x_i)\log_bP(x_i)
$$
$b$通常取2，自然常数e，或10，相应熵的单位分别是bit、nat、Hart。

注意$\lim \limits_{p->0}p\log_bp=0$。

还可以定义事件$X$与$Y$分别取$x_i$和$y_j$时的**条件熵**为
$$
H(X|Y) = -\sum_{i,j}p(x_i, y_j)\log{\frac{p(x_i,y_j)}{p(y_j)}}
$$
条件熵可以理解为是衡量已知$Y$的前提下变量$X$的随机性。



**经典例子**


![image-20190806193351718](http://ww3.sinaimg.cn/large/006tNc79ly1g5qa0yk217j30ds0dg44c.jpg)

![image-20190806194124579](http://ww2.sinaimg.cn/large/006tNc79ly1g5qa2qojnqj30pn0byjs7.jpg)

变量Play的信息熵如下：


$$
H(Play) = -[\frac{9}{14}*\log\frac{9}{14}]-[\frac{5}{14}*\log\frac{5}{14}]
$$


分别计算$H(Play|Outlook)，H(Play|Temperature)，H(Play|Humidity)，H(Play|Windy)$四个条件熵。

特征$A$对数据集$D$的信息增益 $g(D,A)=H(D)-H(D|A)$，这里$H(D)$就是$H(Play)$。选择信息增益最大的特征作为当前的分裂特征。



信息增益率$g_r(D,A)=g_r(D,A)/H(A)$

P2：基尼系数



剪枝算法 - 过拟合



## 随机森林

下面重点介绍随机森林，包括器思想、分析、推广、实现与应用。



**随机森林思想**





## 参考

[决策树和随机森林-youtube视频](https://www.youtube.com/watch?v=EFaVlXWLYkQ)

附录A — 希腊字母发音对照表

![image-20190806195643020](http://ww4.sinaimg.cn/large/006tNc79ly1g5qa0e4cb2j30ex0f8abe.jpg)